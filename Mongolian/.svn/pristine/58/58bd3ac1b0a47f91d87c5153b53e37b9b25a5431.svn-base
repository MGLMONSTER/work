webpackJsonp([59],{l4av:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i("B+Uh"),a=i("IcnI"),n={name:"otlMeeting",data:function(){return{form:{meetingTitle:void 0,title:void 0,beginTime:void 0,place:void 0,needApply:void 0,applyStatus:void 0,applyUid:void 0,meetingStatus:void 0,createdUid:void 0,readTotal:void 0,createdTime:void 0,updatedTime:void 0},formMeet:{mtid:"",title:"组织活动",meetType:void 0,beginTime:"",endTime:void 0,place:"",needApply:"",accepts:"",applyStatus:void 0,applyUid:void 0,meetingStatus:void 0,createdUid:void 0,readTotal:void 0,createdTime:void 0,updatedTime:void 0,meetingDeptid:void 0,compere:"",comperePhone:void 0,remarks:"",attendance:"",lifeType:void 0},formMeetType:{needApply:void 0,title:void 0,content:"",createdUid:void 0,status:void 0,createdTime:void 0},place:null,meetPeople:[],formMeetResult:{mId:void 0,content:void 0,createdUid:a.a.state.user.userId},UEcontent:null,list:null,tlist:null,total:null,ompTotal:null,ompList:null,listLoading:!0,OmplistLoading:!0,ResultListLoading:!0,listQueryt:{page:null,limit:null,mTId:void 0},userId:a.a.state.user.userId,listQuery:{page:1,limit:10,title:void 0,createdUid:a.a.state.user.userId,lifeType:3},data:[],defaultProps:{children:"childList",label:"name"},tree:[],listQueryOmp:{page:1,limit:10,mId:void 0},listQueryResult:{page:1,limit:10,mId:void 0},modalClose:!1,templateOptions:[],places:[],MeetField:[],meetTypes:[{meetTypeName:"通知",meetTypeId:0}],formTemplate:{meetName:void 0,mtid:void 0},templateRule:{mtid:[{required:!0,message:"请选择模板"}]},meet:{title:[{required:!0,message:"请输入活动名称",trigger:"blur"}],needApply:[{required:!0,message:"请选择类型"}],place:[{required:!0,message:"请选择活动地点",trigger:"change"}],beginTime:[{required:!0,message:"请选择开始时间",trigger:"change"}],endTime:[{required:!0,message:"请选择结束时间",trigger:"change"}],compere:[{required:!0,message:"请输入主持人",trigger:"blur"}],comperePhone:[{required:!0,message:"请输入主持人联系方式"},{type:"number",message:"联系方式必须为数字值"}],remarks:[{required:!0,message:"请输入备注",trigger:"blur"}],attendance:[{required:!0,message:"请输入列席人员",trigger:"blur"}]},omr:null,ommVo:null,omp:null,resultList:null,MeetResultEntity:null,dialogFormVisible:!1,dialogTemplate:!1,dialogStatus:"",otlMeetingManager_btn_edit:!0,otlMeetingManager_btn_del:!1,otlMeetingManager_btn_add:!0,textMap:{update:"编辑",create:"创建"},tableKey:0,tableKey1:1,deptId:"3"}},created:function(){this.getList()},methods:{printContent:function(){var e=document.getElementById("subOutputRank-print");console.log(e.innerHTML);var t=e.innerHTML,i=document.body.innerHTML;return document.body.innerHTML=t,window.print(),window.location.reload(),document.body.innerHTML=i,!1},checkChange:function(e){this.tree=this.$refs.tree.getCheckedKeys(!0)},getList:function(){var e=this;this.listLoading=!0,Object(l.m)(this.listQuery).then(function(t){e.list=t.data.rows,e.total=t.data.total,e.listLoading=!1}),Object(l.p)().then(function(t){e.places=t}),Object(l.o)(this.deptId).then(function(t){e.data=t})},getOmpList:function(){var e=this;this.OmplistLoading=!0,Object(l.l)(this.listQueryOmp).then(function(t){e.ompList=t.data.rows,e.ompTotal=t.data.total,e.OmplistLoading=!1})},getMeetResult:function(){var e=this;this.ResultListLoading=!0,Object(l.s)(this.listQueryResult).then(function(t){e.resultList=t.data.rows,e.resultTotal=t.data.total,e.ResultListLoading=!1})},needType:function(){0===this.formMeet.needApply?this.formMeet.accepts="下级党组织":1===this.formMeet.needApply&&(this.formMeet.accepts="上级党组织党务工作者")},placeChange:function(e){var t=this;Object(l.k)(e).then(function(e){t.place=e.data})},Release:function(e){var t=this;this.tree=this.$refs.tree.getCheckedKeys(!0),this.formMeet.mtid=this.formMeetType.mtid,this.formMeet.lifeType=3,this.formMeet.createdUid=this.userId,this.formMeet.meetType="组织活动";var i=this.$refs;i[e].validate(function(a){a&&t.$confirm("此操作将会发布活动, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.b)(t.formMeet).then(function(a){0!=t.tree.length&&(t.tree.forEach(function(e,i){t.meetPeople.push({uid:e})}),Object(l.d)(t.meetPeople).then(function(e){}),t.meetPeople=[]),t.tlist=void 0,t.MeetField=[],t.dialogTemplate=!1,t.$notify({title:"成功",message:"发布成功",type:"success",duration:2e3}),i[e].resetFields(),t.flag=!0,t.getList()}),null!=t.place&&(t.place.total=++t.place.total,Object(l.r)(t.formMeet.place,t.place).then(function(){}))})})},handleFilter:function(){this.getList()},handleSizeChange:function(e){this.listQuery.limit=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()},handleResultSizeChange:function(e){this.listQueryResult.limit=e,this.getMeetResult()},handleResultCurrentChange:function(e){this.listQueryResult.page=e,this.getMeetResult()},handleCreate:function(){var e=this;this.dialogStatus="create",this.dialogTemplate=!0,Object(l.g)("3").then(function(t){0!=t.length&&(e.formMeet=t[0],e.formMeet.comperePhone=parseInt(e.formMeet.comperePhone),e.placeChange(e.formMeet.place))})},handleUpdate:function(e){var t=this;Object(l.j)(e.mid).then(function(e){t.form=e.data.rows,t.ommVo=t.form[0].ommVo,t.dialogFormVisible=!0,t.dialogStatus=t.form[0].meetingTitle}),this.listQueryOmp.mId=e.mid,this.getOmpList(),this.listQueryResult.mId=e.mid,this.getMeetResult()},cancelTable:function(){this.dialogFormVisible=!1},handleOmpSizeChange:function(e){this.listQueryOmp.limit=e,this.getOmpList()},handleOmpCurrentChange:function(e){this.listQueryOmp.page=e,this.getOmpList()},goBack:function(){this.dialogFormVisible=!1,this.flag=!0},getUEContent:function(){return this.$refs.ue.getUEContent()},cancel:function(e){this.dialogTemplate=!1,this.flag=!0,this.$refs[e].resetFields()},addMeetResult:function(){var e=this;this.formMeetResult.mId=this.form[0].mid,this.formMeetResult.content=this.getUEContent(),console.log(this.formMeetResult),Object(l.e)(this.formMeetResult).then(function(){e.dialogFormVisible=!1,e.$notify({title:"成功",message:"创建成功",type:"success"})})}}},o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container calendar-list-container"},[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"姓名或账户"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.handleFilter(t)}},model:{value:e.listQuery.title,callback:function(t){e.$set(e.listQuery,"title",t)},expression:"listQuery.title"}}),e._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"search"},on:{click:e.handleFilter}},[e._v("搜索")]),e._v(" "),e.otlMeetingManager_btn_add?i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"edit"},on:{click:e.handleCreate}},[e._v("添加活动")]):e._e()],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",label:"活动名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.title))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"活动类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.meetType))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"开始时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.beginTime))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"支部"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.organizationDesc))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"活动跟踪"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.meetingStatusMessage))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"阅读状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticStyle:{color:"green"}},[e._v("已读"+e._s(t.row.sumIsRead)+"人")]),e._v(","),i("span",{staticStyle:{color:"red"}},[e._v("未读"+e._s(t.row.sumNotRead)+"人")])]}}])}),e._v(" "),i("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.otlMeetingManager_btn_edit?i("el-button",{attrs:{size:"small",type:"success"},on:{click:function(i){e.handleUpdate(t.row)}}},[e._v("\n            查看\n          ")]):e._e()]}}])})],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.listQuery,"page",t)}}})],1),e._v(" "),i("el-dialog",{attrs:{title:"组织活动",visible:e.dialogTemplate,width:"45%","close-on-click-modal":e.modalClose},on:{"update:visible":function(t){e.dialogTemplate=t}}},[i("el-form",{ref:"formMeet",attrs:{"label-width":"150px",model:e.formMeet,rules:e.meet}},[i("el-form-item",{attrs:{label:"活动名称",prop:"title"}},[i("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"请输入活动名称"},model:{value:e.formMeet.title,callback:function(t){e.$set(e.formMeet,"title",t)},expression:"formMeet.title"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"发起类型",prop:"needApply"}},[i("el-select",{staticStyle:{width:"60%"},attrs:{placeholder:"请选择类型"},on:{change:function(t){e.needType(e.formMeet.needApply)}},model:{value:e.formMeet.needApply,callback:function(t){e.$set(e.formMeet,"needApply",t)},expression:"formMeet.needApply"}},e._l(e.meetTypes,function(e){return i("el-option",{key:e.meetTypeId,attrs:{label:e.meetTypeName,value:e.meetTypeId}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"接收方"}},[i("el-input",{staticStyle:{width:"60%"},attrs:{disabled:!0},model:{value:e.formMeet.accepts,callback:function(t){e.$set(e.formMeet,"accepts",t)},expression:"formMeet.accepts"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"参与人员"}},[i("el-tree",{ref:"tree",attrs:{data:e.data,props:e.defaultProps,"show-checkbox":"","node-key":"id","default-checked-keys":[-1]},on:{"check-change":e.checkChange}})],1),e._v(" "),i("el-form-item",{attrs:{label:"列席人员",prop:"attendance"}},[i("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"请输入列席人员"},model:{value:e.formMeet.attendance,callback:function(t){e.$set(e.formMeet,"attendance",t)},expression:"formMeet.attendance"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"拟定地点",prop:"place"}},[i("el-select",{staticStyle:{width:"60%"},attrs:{placeholder:"请选择"},on:{change:e.placeChange},model:{value:e.formMeet.place,callback:function(t){e.$set(e.formMeet,"place",t)},expression:"formMeet.place"}},e._l(e.places,function(e){return i("el-option",{key:e.id,attrs:{label:e.place,value:e.id}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"开始时间",prop:"beginTime"}},[i("el-date-picker",{staticStyle:{width:"60%"},attrs:{type:"datetime",placeholder:"选择日期时间","value-format":"yyyy-MM-dd HH:mm"},model:{value:e.formMeet.beginTime,callback:function(t){e.$set(e.formMeet,"beginTime",t)},expression:"formMeet.beginTime"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"结束时间",prop:"endTime"}},[i("el-date-picker",{staticStyle:{width:"60%"},attrs:{type:"datetime",placeholder:"选择日期时间","value-format":"yyyy-MM-dd HH:mm"},model:{value:e.formMeet.endTime,callback:function(t){e.$set(e.formMeet,"endTime",t)},expression:"formMeet.endTime"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"主持人",prop:"compere"}},[i("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"请输入主持人"},model:{value:e.formMeet.compere,callback:function(t){e.$set(e.formMeet,"compere",t)},expression:"formMeet.compere"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"主持人联系方式",prop:"comperePhone"}},[i("el-input",{staticStyle:{width:"60%"},attrs:{"auto-complete":"off",placeholder:"请输入支持人联系方式"},model:{value:e.formMeet.comperePhone,callback:function(t){e.$set(e.formMeet,"comperePhone",e._n(t))},expression:"formMeet.comperePhone"}})],1),e._v(" "),i("i",{domProps:{innerHTML:e._s(e.formMeetType.content)}}),e._v(" "),i("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[i("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入备注信息"},model:{value:e.formMeet.remarks,callback:function(t){e.$set(e.formMeet,"remarks",t)},expression:"formMeet.remarks"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"success"},on:{click:function(t){e.cancel("formMeet")}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.Release("formMeet")}}},[e._v("发布")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:e.dialogStatus,visible:e.dialogFormVisible,id:"subOutputRank-print"},on:{"update:visible":function(t){e.dialogFormVisible=t}},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{"text-align":"center"}},[i("h1",[e._v(e._s(e.form[0].title))])]),e._v(" "),i("p",[e._v("开始时间："+e._s(e.form[0].beginTime))]),e._v(" "),i("p",[e._v("活动地点："+e._s(e.form[0].place))]),e._v(" "),i("p",[e._v("接收方："+e._s(e.form[0].accepts))]),e._v(" "),i("p",[e._v("发起类型："+e._s(e.form[0].enumDesc))]),e._v(" "),i("p",[e._v("主持人："+e._s(e.form[0].compere))]),e._v(" "),i("p",[e._v("主持人联系方式："+e._s(e.form[0].comperePhone))]),e._v(" "),i("p",[e._v("列席人员："+e._s(e.form[0].attendance))]),e._v(" "),e._l(e.ommVo,function(t){return i("p",[e._v(e._s(t.field)+" : "+e._s(t.fieldValue))])}),e._v(" "),i("div",[e._v("备注："+e._s(e.form[0].remarks))]),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.ompList,border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",label:"参与人员"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"阅读状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.isRead?i("span",{staticStyle:{color:"red"}},[e._v("未阅读")]):i("span",{staticStyle:{color:"green"}},[e._v("已阅读")])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"阅读时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.readTime))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"签到状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.isSignin?i("span",{staticStyle:{color:"red"}},[e._v("未签到")]):i("span",{staticStyle:{color:"green"}},[e._v("已签到")])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"签到时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.signTime))])]}}])})],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":e.listQueryOmp.page,"page-sizes":[10,20,30,50],"page-size":e.listQueryOmp.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.ompTotal},on:{"size-change":e.handleOmpSizeChange,"current-change":e.handleOmpCurrentChange,"update:currentPage":function(t){e.$set(e.listQueryOmp,"page",t)}}})],1),e._v(" "),i("p",{staticStyle:{"text-align":"right"}},[e._v("创建于："+e._s(e.form[0].createdTime))])]}}])},[i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"success"},on:{click:function(t){e.addMeetResult()}}},[e._v("评 论")]),e._v(" "),i("el-button",{attrs:{type:"success"},on:{click:function(t){e.printContent()}}},[e._v("打印")]),e._v(" "),i("el-button",{attrs:{type:"success"},on:{click:function(t){e.goBack()}}},[e._v("返 回")])],1)])],1)},staticRenderFns:[]},s=i("VU/8")(n,o,!1,null,null,null);t.default=s.exports}});